<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“š ä¸ªäººè‹±è¯­å­¦ä¹ è¯æ±‡è¡¨ - åº“æ´›ç±³å­¦ä¹ ç•Œé¢</title>
    <style>
        /* --- V8.0 åº“æ´›ç±³ Kuromi Aesthetic Theme --- */

        /* --- æ•´ä½“å¸ƒå±€ä¸å…¬å…±æ ·å¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #1a1a1a; /* Kuromi: Dark Background */
            color: #e0e0e0; /* Kuromi: Light Text */
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background-color: #ffffff; /* White center for contrast */
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(255, 105, 180, 0.5); /* Hot Pink Shadow */
        }
        h1 {
            color: #ff69b4; /* Hot Pink */
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px #333;
        }
        h2 {
            color: #8a2be2; /* Blue Violet/Purple */
            border-left: 5px solid #ff69b4;
            padding-left: 10px;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        /* --- æ¨¡å¼é€‰æ‹©å™¨æ ·å¼ --- */
        .mode-selector {
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .mode-selector button {
            padding: 12px 15px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid #ff69b4; /* Pink border */
            border-radius: 6px;
            transition: background-color 0.3s, transform 0.1s, color 0.3s;
            background-color: #2c3e50; /* Dark button base */
            color: #ff69b4; /* Pink text */
        }
        .mode-selector button:hover {
            transform: translateY(-2px);
            background-color: #ff69b4; /* Pink hover fill */
            color: #1a1a1a; /* Dark text on hover */
        }

        /* --- åˆ—è¡¨è§†å›¾æ ·å¼ --- */
        #listView table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 30px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            color: #333; /* Ensure readability inside white container */
        }
        #listView th, #listView td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #f2f2f2;
        }
        #listView th {
            background-color: #1a1a1a; /* Black header */
            color: #ff69b4; /* Pink text */
            font-weight: 700;
        }
        #listView tr:nth-child(even) {
            background-color: #f7f7f7;
        }
        .word-cell {
            font-weight: bold;
            color: #ff69b4; /* Hot Pink for words */
            cursor: pointer;
            transition: color 0.2s;
        }
        .word-cell:hover {
            color: #8a2be2; /* Purple hover */
            text-decoration: underline;
        }
        .pos {
            font-style: italic;
            color: #7f8c8d;
        }
        .pron {
            font-family: 'Lucida Sans Unicode', 'Arial Unicode MS', sans-serif;
            color: #2ecc71; /* Keep green for pronunciation, it contrasts well */
        }

        /* --- å¡ç‰‡æ¨¡å¼æ ·å¼ --- */
        #flashcardView {
            display: none; 
            text-align: center;
            padding-top: 50px;
        }
        .card-container {
            perspective: 1000px;
            width: 350px;
            height: 250px;
            margin: 30px auto;
        }
        .flashcard {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        .flashcard.flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px; /* Softer edges */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .card-front {
            background-color: #1a1a1a; /* Black front */
            color: #ff69b4; /* Pink text */
            font-size: 3em;
            font-weight: 700;
            border: 3px solid #8a2be2; /* Purple border */
        }
        .card-back {
            background-color: #f7f7f7; /* Light back */
            color: #1a1a1a;
            transform: rotateY(180deg);
            text-align: left;
            font-size: 1.1em;
            border: 3px solid #ff69b4; /* Pink border */
        }
        .card-back p {
            margin: 5px 0;
            line-height: 1.4;
        }
        .card-back .definition {
            font-weight: bold;
            font-size: 1.3em;
            color: #ff69b4; /* Pink definition */
        }
        .card-back .example {
            font-style: italic;
            font-size: 0.9em;
            color: #2c3e50;
        }
        .card-controls button {
            background-color: #8a2be2;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-weight: bold;
        }
        .card-controls button:hover {
            background-color: #ff69b4;
        }

        /* --- å¬å†™å’Œå® ç‰©æ¸¸æˆå…±ç”¨æ ·å¼ --- */
        .quiz-area {
            max-width: 500px; 
            margin: 30px auto; 
            padding: 30px; 
            border-radius: 10px; 
            border: 3px solid #ff69b4; /* Pink Border */
            background-color: #fff0f5; /* Very light pink background */
            color: #1a1a1a;
        }
        .quiz-area h3 {
            color: #8a2be2; /* Purple instruction */
        }
        input[type="text"] {
            width: 80%; 
            padding: 12px; 
            font-size: 1.1em; 
            border: 2px solid #8a2be2 !important;
            border-radius: 5px; 
            margin-bottom: 15px;
            transition: border-color 0.2s, background-color 0.2s;
        }
        input[type="text"]:focus {
            border-color: #ff69b4 !important;
            box-shadow: 0 0 5px rgba(255, 105, 180, 0.5);
            outline: none;
        }
        #quizSpeakBtn {
            padding: 15px 30px; 
            font-size: 1.5em; 
            background-color: #ff69b4 !important; /* Pink speak button */
            color: white;
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin-bottom: 20px;
        }
        #quizSubmitBtn, #dogGameSubmitBtn {
            padding: 12px 25px; 
            font-size: 1.1em; 
            background-color: #1a1a1a !important; /* Black submit */
            color: #ff69b4 !important;
            border: 2px solid #ff69b4 !important;
            border-radius: 5px; 
            cursor: pointer;
            font-weight: bold;
        }
        #quizNextBtn, #dogGameNextBtn {
            padding: 12px 25px; 
            font-size: 1.1em; 
            background-color: #8a2be2 !important; /* Purple next */
            color: white !important;
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
            font-weight: bold;
        }
        
        /* --- æ˜“æ··æ·†é…å¯¹æ ·å¼ --- */
        .match-card {
            border: 2px solid #ff69b4; 
            padding: 15px; 
            border-radius: 8px; 
            background-color: #fef0fe; /* Light pink background */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .match-card strong {
            color: #ff69b4;
        }

        /* --- ğŸ¶ å® ç‰©é¢†å…»æŒ‘æˆ˜æ ·å¼ --- */
        .dog-container {
            border: 3px solid #8a2be2; /* Purple border */
            background-color: #2c3e50; /* Dark blue/gray internal background */
            color: white;
        }
        #dogStatus, #boneCount {
            color: #ff69b4; /* Pink status */
            font-weight: bold;
        }
        #dogAvatar {
            color: #ff69b4;
        }
        #dogGameFeedback {
            font-size: 1.1em;
        }
        /* é¢œè‰²åé¦ˆï¼Œä½¿ç”¨ç²‰è‰²/ç´«è‰²ä»£æ›¿é»˜è®¤ç»¿è‰²/çº¢è‰²ï¼Œä½†ä¿ç•™å«ä¹‰ */
        #dogGameFeedback[style*="#2ecc71"] { /* Correct (Green) -> Pink */
            color: #ff69b4 !important; 
        }
        #dogGameFeedback[style*="#e74c3c"] { /* Incorrect (Red) -> Pink/Purple */
            color: #8a2be2 !important; 
        }

        /* Memorize Button */
        #memorizeWordBtn {
            background-color: #ff69b4 !important; 
            color: #1a1a1a !important;
            border: none;
            font-weight: bold;
        }
        #wordReviewArea {
            border: 2px dashed #ff69b4 !important;
            background-color: #1a1a1a !important;
            color: white !important;
        }
        #reviewContent strong {
            color: #8a2be2 !important;
        }
        #reviewContent span {
            color: #ff69b4 !important;
        }

        /* --- ç§»åŠ¨ç«¯ä¼˜åŒ– --- */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .container { padding: 15px; }
            .mode-selector button { font-size: 12px; padding: 10px 12px; }
            /* åˆ—è¡¨æ¨¡å¼ï¼šå †å è¡¨æ ¼ */
            #listView table, #listView thead, #listView tbody, #listView th, #listView td, #listView tr { display: block; }
            #listView tr { margin-bottom: 15px; border: 1px solid #f2f2f2; border-radius: 8px; overflow: hidden; }
            #listView td {
                border-bottom: 1px solid #f2f2f2; text-align: right; padding-left: 50%; position: relative;
                color: #333; /* Ensure readability */
            }
            #listView td::before {
                content: attr(data-label); position: absolute; left: 10px; width: 45%; padding-right: 10px; white-space: nowrap; font-weight: 600; color: #1a1a1a; text-align: left;
            }
            #listView th { display: none; }
            /* å¡ç‰‡æ¨¡å¼ */
            .card-container { width: 95%; height: 200px; }
            .card-front { font-size: 2em; }
            .card-back { font-size: 1em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š ä¸ªäººè‹±è¯­å­¦ä¹ è¯æ±‡è¡¨ - Kuromi Style ğŸ–¤ğŸ’–</h1>
        
        <div class="mode-selector">
            <button id="listViewBtn">ğŸ“ åˆ—è¡¨å­¦ä¹ æ¨¡å¼</button>
            <button id="flashcardBtn">ğŸƒ å¡ç‰‡ç¿»è½¬æ¨¡å¼</button>
            <button id="quizModeBtn">âœï¸ å¬å†™æµ‹è¯•æ¨¡å¼</button>
            <button id="matchModeBtn">ğŸ”— æ˜“æ··æ·†è¯é…å¯¹</button>
            <button id="dogGameBtn">ğŸ¶ å® ç‰©é¢†å…»æŒ‘æˆ˜</button>
        </div>

        <div id="listView">
            <p style="text-align: center; color: #ff69b4; font-weight: 500;">**åˆ—è¡¨æ¨¡å¼ï¼šç‚¹å‡»è¡¨æ ¼ä¸­ç²—ä½“çš„è‹±æ–‡å•è¯ï¼Œå³å¯å¬åˆ°æ­£ç¡®çš„å‘éŸ³ï¼**</p>
            <div id="vocabulary-list">
                </div>
        </div>

        <div id="flashcardView">
            <div class="card-container">
                <div class="flashcard" onclick="flipCard()">
                    <div class="card-face card-front" id="cardFront">
                        </div>
                    <div class="card-face card-back" id="cardBack">
                        </div>
                </div>
            </div>

            <div class="card-controls">
                <button id="pronounceCardBtn" onclick="speak(currentWordList[currentCardIndex].word)">ğŸ”Š å¬å‘éŸ³</button>
                <button id="prevCardBtn">â¬…ï¸ ä¸Šä¸€ä¸ª</button>
                <button id="nextCardBtn">ä¸‹ä¸€ä¸ª â¡ï¸</button>
            </div>
            <div class="card-info" style="color: #1a1a1a;">
                å½“å‰å•è¯ï¼š<span id="cardCount">1</span> / <span id="totalCards">0</span>
                <p id="cardCategory" style="font-size: 0.9em; margin-top: 5px;"></p>
            </div>
        </div>

        <div id="quizView" style="display: none; text-align: center; padding: 50px 20px;">
            <h2>âœï¸ å¬å†™ä¸æ‹¼å†™æµ‹è¯•</h2>
            <p id="quizCategory" style="color: #7f8c8d;">åˆ†ç±»ï¼š</p>
            <div class="quiz-area">
                <h3 id="quizInstruction">ç‚¹å‡»æŒ‰é’®å¬å•è¯ï¼š</h3>
                
                <button id="quizSpeakBtn">
                    ğŸ”Š æ’­æ”¾å•è¯
                </button>

                <input type="text" id="quizInput" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨å¬åˆ°çš„å•è¯">
                
                <button id="quizSubmitBtn">
                    æäº¤ç­”æ¡ˆ
                </button>

                <p id="quizFeedback" style="font-weight: bold; margin-top: 20px; min-height: 20px;"></p>
            </div>
            
            <div class="quiz-score" style="margin-top: 30px; color: #1a1a1a;">
                <button id="quizNextBtn">
                    ä¸‹ä¸€ä¸ªå•è¯ â¡ï¸
                </button>
                <p>å¾—åˆ†ï¼š<span id="scoreCorrect">0</span> / <span id="scoreTotal">0</span></p>
            </div>
        </div>

        <div id="matchView" style="display: none; padding: 20px;">
            <h2>ğŸ”— æ˜“æ··æ·†è¯é…å¯¹å­¦ä¹ </h2>
            <p style="text-align: center; color: #8a2be2; font-weight: 500;">ç‚¹å‡»å•è¯å¯å¬å–å‘éŸ³ã€‚è¯·ä»”ç»†å¯¹æ¯”å·¦æ å•è¯å’Œå³æ æ˜“æ··æ·†è¯ï¼Œå›å¿†å®ƒä»¬çš„ä¸­æ–‡æ„æ€ã€‚</p>
            <div id="matchListContainer" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                </div>
        </div>

        <div id="dogGameView" style="display: none; text-align: center; padding: 50px 20px;">
            <h2>ğŸ¶ å® ç‰©é¢†å…»æŒ‘æˆ˜ï¼šæ‹¼å†™åˆé¤ï¼</h2>
            <div class="quiz-area dog-container">
                
                <h3 id="dogStatus">ğŸ‰ ä½ é¢†å…»äº†ä¸€åªå°ç‹—ï¼</h3>
                
                <div style="font-size: 2em; margin-bottom: 15px;">
                    ğŸš ç‹—ç²®ï¼š<span id="boneCount">0</span> ä»½
                </div>

                <div id="dogAvatar">
                    ğŸ•
                </div>
                <p id="dogMood" style="font-style: italic;">å°ç‹—å¾ˆæœŸå¾…ä½ çš„æŒ‘æˆ˜ï¼</p>

                <hr style="border-top: 1px dashed #ff69b4; margin: 20px 0;">

                <h3 id="dogGameQuestion" style="min-height: 40px;">è¯·å›ç­”ï¼š</h3>
                
                <input type="text" id="dogGameInput" placeholder="åœ¨æ­¤è¾“å…¥è‹±æ–‡å•è¯æ‹¼å†™">
                
                <button id="dogGameSubmitBtn">
                    æäº¤ç­”æ¡ˆ
                </button>
                
                <button id="dogGameNextBtn" style="display: none;">
                    ä¸‹ä¸€é¢˜ â¡ï¸
                </button>

                <p id="dogGameFeedback" style="font-weight: bold; margin-top: 20px; min-height: 20px;"></p>

                <button id="memorizeWordBtn" onclick="toggleDogReview()" style="display: none;">
                    ğŸ¶ å¸®æˆ‘è®°å•è¯ (æŸ¥çœ‹è¯¦æƒ…)
                </button>

                <div id="wordReviewArea" style="display: none;">
                    <p style="font-weight: bold;">ã€é”™è¯¯å›é¡¾ã€‘å°ç‹—å¸®ä½ å¼ºåŒ–è®°å¿†ï¼š</p>
                    <div id="reviewContent"></div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- æ ¸å¿ƒè¯æ±‡æ•°æ® ---
        const vocabularyData = [
            { category: "ä¸€ã€ ç”Ÿç‰©ä¸èº«ä½“éƒ¨ä½ (Biology & Body Parts)", shortCategory: "ç”Ÿç‰©/èº«ä½“", words: [
                { word: "Gills", pos: "åè¯ (N.)", def: "é±¼é³ƒ", pron: "/gÉªlz/", example: "The fish breathes using its gills.", confusable: "Grills (çƒ¤æ¶)" },
                { word: "Leg", pos: "åè¯ (N.)", def: "è…¿", pron: "/lÉ›g/", example: "A horse has four legs.", confusable: "Lag (æ»å)" },
                { word: "Feathers", pos: "åè¯ (N.)", def: "ç¾½æ¯›", pron: "/ËˆfÉ›Ã°É™rz/", example: "The bird smoothed its feathers with its beak.", confusable: "Leather (çš®é©)" },
                { word: "Scales", pos: "åè¯ (N.)", def: "é±¼é³ï¼›åˆ»åº¦ï¼›å¤©å¹³", pron: "/skeÉªlz/", example: "Most fish are covered in scales.", confusable: "Sails (èˆ¹å¸†)" },
                { word: "Mouth", pos: "åè¯ (N.)", def: "å˜´å·´", pron: "/maÊŠÎ¸/", example: "Open your mouth and say 'Ah.'", confusable: "Mouse (è€é¼ )" }
            ]},
            { category: "äºŒã€ åŠ¨ç‰©ä¸è¡Œä¸º (Animals & Actions)", shortCategory: "åŠ¨ç‰©/è¡Œä¸º", words: [
                { word: "Eagle", pos: "åè¯ (N.)", def: "é¹°", pron: "/ËˆiËgÉ™l/", example: "The eagle soared high above the mountains.", confusable: "Eager (æ¸´æœ›çš„)" },
                { word: "Squawk", pos: "åŠ¨è¯ (V.)", def: "(é¸Ÿç±»ç­‰) å˜å˜åœ°å«ï¼›å°–å«", pron: "/skwÉ”Ëk/", example: "The parrot gave a loud squawk when the cat came near.", confusable: "Quack (é¸­å«å£°)" },
                { word: "Creeps", pos: "åŠ¨è¯ (V.)", def: "çˆ¬è¡Œï¼›å·å·åœ°ç¼“æ…¢ç§»åŠ¨", pron: "/kriËps/", example: "The cat creeps up on the mouse quietly.", confusable: "Crisp (è„†çš„)" },
                { word: "Chases", pos: "åŠ¨è¯ (V.)", def: "è¿½é€ï¼›è¿½èµ¶", pron: "/ËˆtÊƒeÉªsÉªz/", example: "The dog chases the ball in the park.", confusable: "Choices (é€‰æ‹©)" },
                { word: "Hunt", pos: "åŠ¨è¯ (V.)", def: "æ‰“çŒï¼›æœå¯»", pron: "/hÊŒnt/", example: "Lions hunt for food at night.", confusable: "Hut (å°å±‹)" },
                { word: "flies", pos: "åŠ¨è¯ (V.)", def: "é£", pron: "/flaÉªz/", example: "An airplane flies in the sky.", confusable: "Fries (è–¯æ¡)" },
                { word: "horse", pos: "åè¯ (N.)", def: "é©¬", pron: "/hÉ”Ërs/", example: "She rode a brown horse on the farm.", confusable: "Hoarse (æ²™å“‘çš„)" }
            ]},
            { category: "ä¸‰ã€ çŠ¶æ€ã€æƒ…æ„Ÿä¸æè¿° (States, Emotions & Descriptions)", shortCategory: "çŠ¶æ€/æè¿°", words: [
                { word: "Quietly", pos: "å‰¯è¯ (Adv.)", def: "å®‰é™åœ°ï¼›æ‚„æ‚„åœ°", pron: "/ËˆkwaÉªÉ™tli/", example: "She closed the door quietly so as not to wake the baby.", confusable: "Quickly (å¿«é€Ÿåœ°)" },
                { word: "Right", pos: "å‰¯è¯/å½¢å®¹è¯/åè¯ (Adv./Adj./N.)", def: "æ­£ç¡®çš„ï¼›å³è¾¹çš„ï¼›æƒåˆ©", pron: "/raÉªt/", example: "You gave the right answer.", confusable: "Write (å†™), Rite (ä»ªå¼)" },
                { word: "Scared", pos: "å½¢å®¹è¯ (Adj.)", def: "å®³æ€•çš„ï¼›å—æƒŠçš„", pron: "/skÉ›rd/", example: "The little boy was scared of the dark.", confusable: "Scarred (æœ‰ç–¤ç—•çš„)" },
                { word: "Apart", pos: "å‰¯è¯ (Adv.)", def: "åˆ†å¼€åœ°ï¼›åˆ†ç¦»åœ°", pron: "/É™ËˆpÉ‘Ërt/", example: "The old building was torn apart.", confusable: "A part (ä¸€éƒ¨åˆ†)" },
                { word: "Always", pos: "å‰¯è¯ (Adv.)", def: "æ€»æ˜¯ï¼›ä¸€ç›´", pron: "/ËˆÉ”ËlweÉªz/", example: "I always drink coffee in the morning.", confusable: "All ways (æ‰€æœ‰æ–¹å¼)" },
                { word: "Nervous", pos: "å½¢å®¹è¯ (Adj.)", def: "ç´§å¼ çš„ï¼›ä¸å®‰çš„", pron: "/ËˆnÉœËrvÉ™s/", example: "She felt nervous before the big presentation.", confusable: "Nerve (ç¥ç»)" },
                { word: "Fierce", pos: "å½¢å®¹è¯ (Adj.)", def: "å‡¶çŒ›çš„ï¼›æ¿€çƒˆçš„", pron: "/fÉªÉ™rs/", example: "A tiger is a fierce predator.", confusable: "Pierce (åˆºç©¿)" },
                { word: "Solid", pos: "å½¢å®¹è¯ (Adj.)", def: "å›ºä½“çš„ï¼›åšå›ºçš„", pron: "/ËˆsÉ‘ËlÉªd/", example: "Ice is water in a solid state.", confusable: "Solemn (ä¸¥è‚ƒçš„)" },
                { word: "awful", pos: "å½¢å®¹è¯ (Adj.)", def: "ç³Ÿç³•çš„ï¼›å¯æ€•çš„", pron: "/ËˆÉ”ËfÉ™l/", example: "The weather was awful all day.", confusable: "Offal (å†…è„)" },
                { word: "safe", pos: "å½¢å®¹è¯ (Adj.)", def: "å®‰å…¨çš„", pron: "/seÉªf/", example: "Keep your valuables in a safe place.", confusable: "Save (ä¿å­˜)" },
                { word: "quiet", pos: "å½¢å®¹è¯ (Adj.)", def: "å®‰é™çš„", pron: "/ËˆkwaÉªÉ™t/", example: "Please be quiet in the library.", confusable: "Quite (ç›¸å½“åœ°)" },
                { word: "Cool", pos: "å½¢å®¹è¯ (Adj.)", def: "å‡‰çˆ½çš„ï¼›é…·çš„", pron: "/kuËl/", example: "The weather is getting cool in the autumn.", confusable: "Cold (å¯’å†·çš„)" },
                { word: "Awesome", pos: "å½¢å®¹è¯ (Adj.)", def: "æå¥½çš„ï¼›äº†ä¸èµ·çš„", pron: "/ËˆÉ”ËsÉ™m/", example: "The view from the top of the mountain was awesome.", confusable: "Awful (ç³Ÿç³•çš„)" }
            ]},
            { category: "å››ã€ æŠ½è±¡æ¦‚å¿µä¸ç‰©ç†å˜åŒ– (Abstract Concepts & Physical Changes)", shortCategory: "æ¦‚å¿µ/ç‰©ç†", words: [
                { word: "Noise", pos: "åè¯ (N.)", def: "å™ªéŸ³ï¼›å“å£°", pron: "/nÉ”Éªz/", example: "The sudden noise woke me up.", confusable: "Nose (é¼»å­)" },
                { word: "Escape", pos: "åŠ¨è¯ (V.)", def: "é€ƒè·‘ï¼›é€ƒè„±", pron: "/ÉªËˆskeÉªp/", example: "The bird managed to escape from its cage.", confusable: "Scrape (åˆ®æ“¦)" },
                { word: "Escapes", pos: "åŠ¨è¯ (V.)", def: "é€ƒè„± (ç¬¬ä¸‰äººç§°å•æ•°)", pron: "/ÉªËˆskeÉªps/", example: "The truth often escapes detection.", confusable: "Scapes (é£æ™¯)" },
                { word: "Flow", pos: "åè¯/åŠ¨è¯ (N./V.)", def: "æµåŠ¨ï¼›æµé‡", pron: "/floÊŠ/", example: "The river's flow is strongest in spring.", confusable: "Flew (é£è¡Œçš„è¿‡å»å¼)" },
                { word: "Winter", pos: "åè¯ (N.)", def: "å†¬å¤©", pron: "/ËˆwÉªntÉ™r/", example: "We are looking forward to a snowy winter.", confusable: "Wander (æ¼«æ­¥)" },
                { word: "Steam", pos: "åè¯ (N.)", def: "è’¸æ±½ï¼›æ°´è’¸æ°”", pron: "/stiËm/", example: "Hot water gives off steam.", confusable: "Stream (æºªæµ)" },
                { word: "melt", pos: "åŠ¨è¯ (V.)", def: "èåŒ–", pron: "/mÉ›lt/", example: "The ice cream will melt in the sun.", confusable: "Mailed (é‚®å¯„çš„è¿‡å»å¼)" },
                { word: "heat", pos: "åè¯/åŠ¨è¯ (N./V.)", def: "çƒ­é‡ï¼›åŠ çƒ­", pron: "/hiËt/", example: "The sun provides light and heat.", confusable: "Hit (å‡»æ‰“)" },
                { word: "mixture", pos: "åè¯ (N.)", def: "æ··åˆç‰©", pron: "/ËˆmÉªkstÊƒÉ™r/", example: "The cake batter is a mixture of flour, eggs, and sugar.", confusable: "Mixture (æ··åˆ)" },
                { word: "melted", pos: "å½¢å®¹è¯ (Adj.)", def: "èåŒ–äº†çš„", pron: "/ËˆmÉ›ltÉªd/", example: "The melted butter soaked into the toast.", confusable: "Metal (é‡‘å±)" },
                { word: "liquid", pos: "åè¯ (N.)", def: "æ¶²ä½“", pron: "/ËˆlÉªkwÉªd/", example: "Water is a clear liquid.", confusable: "Lick it (èˆ”å®ƒ)" }
            ]},
            { category: "äº”ã€ äº¤é€šä¸åœ°ç† (Transportation & Geography)", shortCategory: "äº¤é€š/åœ°ç†", words: [
                { word: "Australia", pos: "åè¯ (N.)", def: "æ¾³å¤§åˆ©äºš", pron: "/É”ËËˆstreÉªliÉ™/", example: "Australia is famous for its kangaroos.", confusable: "Austria (å¥¥åœ°åˆ©)" },
                { word: "Egypt", pos: "åè¯ (N.)", def: "åŸƒåŠ", pron: "/ËˆiËdÊ’Éªpt/", example: "The pyramids of Egypt are ancient wonders.", confusable: "Gypsy (å‰æ™®èµ›äºº)" },
                { word: "Cable", pos: "åè¯ (N.)", def: "ç”µç¼†ï¼›é’¢ç´¢", pron: "/ËˆkeÉªbÉ™l/", example: "A thick cable supports the bridge.", confusable: "Able (èƒ½å¹²çš„)" },
                { word: "Truck", pos: "åè¯ (N.)", def: "å¡è½¦ï¼›è´§è½¦", pron: "/trÊŒk/", example: "The truck carried a heavy load of goods.", confusable: "Trek (é•¿é€”è·‹æ¶‰)" },
                { word: "ship", pos: "åè¯ (N.)", def: "èˆ¹ï¼›èˆ°", pron: "/ÊƒÉªp/", example: "The cargo ship sailed across the ocean.", confusable: "Sheep (ç»µç¾Š)" },
                { word: "ocean", pos: "åè¯ (N.)", def: "æµ·æ´‹", pron: "/ËˆoÊŠÊƒÉ™n/", example: "We swam in the warm ocean water.", confusable: "Notion (æ¦‚å¿µ)" },
                { word: "train", pos: "åè¯ (N.)", def: "ç«è½¦ï¼›è®­ç»ƒ", pron: "/treÉªn/", example: "I took the high-speed train to the city.", confusable: "Drain (æ’æ°´)" },
                { word: "airplane", pos: "åè¯ (N.)", def: "é£æœº", pron: "/ËˆÉ›É™rpleÉªn/", example: "We took an airplane to travel overseas.", confusable: "Airy (é€šé£çš„)" },
                { word: "island", pos: "åè¯ (N.)", def: "å²›å±¿", pron: "/ËˆaÉªlÉ™nd/", example: "They visited a beautiful tropical island.", confusable: "Ireland (çˆ±å°”å…°)" },
                { word: "world", pos: "åè¯ (N.)", def: "ä¸–ç•Œ", pron: "/wÉœËrld/", example: "People travel all over the world.", confusable: "Whirl" }
            ]},
            { category: "å…­ã€ æ²Ÿé€šä¸ä¿¡æ¯ (Communication & Information)", shortCategory: "æ²Ÿé€š/ä¿¡æ¯", words: [
                { word: "apostrophe", pos: "åè¯ (N.)", def: "æ’‡å· ( ' )", pron: "/É™ËˆpÉ‘ËstrÉ™fi/", example: "We use an apostrophe in contractions like don't.", confusable: "Apostate (å›æ•™è€…)" },
                { word: "contraction", pos: "åè¯ (N.)", def: "ç¼©å†™è¯ï¼›æ”¶ç¼©", pron: "/kÉ™nËˆtrÃ¦kÊƒÉ™n/", example: "It's is a contraction of it is.", confusable: "Contact (è”ç³»)" },
                { word: "communication", pos: "åè¯ (N.)", def: "äº¤æµï¼›é€šä¿¡", pron: "/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒÉ™n/", example: "Good communication is important in a team.", confusable: "Communion (åœ£é¤)" },
                { word: "information", pos: "åè¯ (N.)", def: "ä¿¡æ¯ï¼›èµ„æ–™", pron: "/ËŒÉªnfÉ™rËˆmeÉªÊƒÉ™n/", example: "The website provides useful information.", confusable: "Formation (å½¢æˆ)" },
                { word: "textmessages", pos: "åè¯ (N.)", def: "æ‰‹æœºçŸ­ä¿¡", pron: "/ËˆtÉ›kstËŒmÉ›sÉªdÊ’Éªz/", example: "I sent him several textmessages yesterday.", confusable: "Textile (çººç»‡å“)" },
                { word: "text", pos: "åè¯ (N.)", def: "æ–‡æœ¬ï¼›æ­£æ–‡", pron: "/tÉ›kst/", example: "The text of the email was very long.", confusable: "Test (æµ‹è¯•)" },
                { word: "send", pos: "åŠ¨è¯ (V.)", def: "å‘é€ï¼›å¯„å‡º", pron: "/sÉ›nd/", example: "Please send the file via email.", confusable: "Sent (å‘é€çš„è¿‡å»å¼)" },
                { word: "internet", pos: "åè¯ (N.)", def: "äº’è”ç½‘", pron: "/ËˆÉªntÉ™rnÉ›t/", example: "We use the internet to search for news.", confusable: "Internal (å†…éƒ¨çš„)" },
                { word: "communicate", pos: "åŠ¨è¯ (V.)", def: "äº¤æµï¼›ä¼ è¾¾", pron: "/kÉ™ËˆmjuËnÉªkeÉªt/", example: "They communicate mainly by email.", confusable: "Commute (é€šå‹¤)" },
                { word: "printed", pos: "å½¢å®¹è¯ (Adj.)", def: "æ‰“å°çš„ï¼›å°åˆ·çš„", pron: "/ËˆprÉªntÉªd/", example: "The printed document is on your desk.", confusable: "Painted (ä¸Šæ¼†çš„)" },
                { word: "mailed", pos: "åŠ¨è¯ (V.)", def: "é‚®å¯„äº†", pron: "/meÉªld/", example: "I mailed the package yesterday.", confusable: "Melted (èåŒ–çš„)" },
                { word: "later", pos: "å‰¯è¯ (Adv.)", def: "åæ¥ï¼›ç¨å", pron: "/ËˆleÉªtÉ™r/", example: "I will call you later this evening.", confusable: "Latter (åè€…)" },
                { word: "letter", pos: "åè¯ (N.)", def: "ä¿¡ï¼›å­—æ¯", pron: "/ËˆlÉ›tÉ™r/", example: "She wrote a long letter to her friend.", confusable: "Latter (åè€…)" },
                { word: "dictionary", pos: "åè¯ (N.)", def: "è¯å…¸ï¼›å­—å…¸", pron: "/ËˆdÉªkÊƒÉ™ËŒnÉ›ri/", example: "I looked up the word in the dictionary.", confusable: "Fiction (å°è¯´)" },
                { word: "alphabetical", pos: "å½¢å®¹è¯ (Adj.)", def: "æŒ‰å­—æ¯é¡ºåºçš„", pron: "/ËŒÃ¦lfÉ™ËˆbÉ›tÉªkÉ™l/", example: "Arrange the names in alphabetical order.", confusable: "Alphanumeric (å­—æ¯æ•°å­—çš„)" }
            ]},
            { category: "ä¸ƒã€ äººç‰©ã€åœ°ç‚¹ä¸æ—¶é—´ (People, Places & Time)", shortCategory: "äººç‰©/åœ°ç‚¹", words: [
                { word: "Apartment", pos: "åè¯ (N.)", def: "å…¬å¯“", pron: "/É™ËˆpÉ‘ËrtmÉ™nt/", example: "They live in a small apartment in the city.", confusable: "Department (éƒ¨é—¨)" },
                { word: "Leo", pos: "ä¸“æœ‰åè¯ (N.)", def: "ç‹®å­åº§ï¼›äººå (åˆ©å¥¥)", pron: "/ËˆliËoÊŠ/", example: "Leo is my brother's name.", confusable: "Liaw (å§“æ°)" },
                { word: "juice", pos: "åè¯ (N.)", def: "æœæ±", pron: "/dÊ’uËs/", example: "I like to drink orange juice for breakfast.", confusable: "Loose (æ¾çš„)" },
                { word: "cafeteria", pos: "åè¯ (N.)", def: "è‡ªåŠ©é¤å…ï¼›é£Ÿå ‚", pron: "/ËŒkÃ¦fÉªËˆtÉªÉ™riÉ™/", example: "We eat lunch in the school cafeteria.", confusable: "Caffeine (å’–å•¡å› )" },
                { word: "vanilla", pos: "åè¯ (N.)", def: "é¦™è‰ (å£å‘³)", pron: "/vÉ™ËˆnÉªlÉ™/", example: "My favorite ice cream flavor is vanilla.", confusable: "Venal (è´ªè´¢çš„)" },
                { word: "friends", pos: "åè¯ (N.)", def: "æœ‹å‹ä»¬", pron: "/frÉ›ndz/", example: "I went to the park with my friends.", confusable: "Fiends (æ¶é­”)" },
                { word: "London", pos: "ä¸“æœ‰åè¯ (N.)", def: "ä¼¦æ•¦", pron: "/ËˆlÊŒndÉ™n/", example: "London is the capital of England.", confusable: "Linden (è©ææ ‘)" },
                { word: "Henry", pos: "ä¸“æœ‰åè¯ (N.)", def: "äººå (äº¨åˆ©)", pron: "/ËˆhÉ›nri/", example: "Henry is a common English name.", confusable: "Hennery (å®¶ç¦½é¥²å…»åœº)" },
                { word: "Lucia", pos: "ä¸“æœ‰åè¯ (N.)", def: "äººå (éœ²è¥¿äºš)", pron: "/luËËˆsiËÉ™/", example: "Lucia is visiting from Spain.", confusable: "Loose eye (æ¾æ•£çš„çœ¼ç›)" },
                { word: "Ellis", pos: "ä¸“æœ‰åè¯ (N.)", def: "å§“æ°/äººå (åŸƒåˆ©æ–¯)", pron: "/ËˆÉ›lÉªs/", example: "My neighbor's name is Ms. Ellis.", confusable: "Alias (åˆ«å)" },
                { word: "Clerks", pos: "åè¯ (N.)", def: "èŒå‘˜ï¼›åº—å‘˜", pron: "/klÉœËrks/", example: "The bank clerks were very helpful.", confusable: "Clacks (å¡å—’å£°)" },
                { word: "Ltaly", pos: "ä¸“æœ‰åè¯ (N.)", def: "æ„å¤§åˆ© (æ­£ç¡®æ‹¼å†™: Italy)", pron: "/ËˆÉªtÉ™li/", example: "I dream of traveling to Italy.", confusable: "Lately (æœ€è¿‘)" }
            ]},
            { category: "å…«ã€ åŠ¨è¯ä¸åŠ©è¯ (Verbs & Particles)", shortCategory: "åŠ¨è¯/åŠ©è¯", words: [
                { word: "Through", pos: "ä»‹è¯ (Prep.)", def: "ç©¿è¿‡ï¼›é€šè¿‡", pron: "/Î¸ruË/", example: "The sunlight came through the window.", confusable: "Threw (æŠ•æ·çš„è¿‡å»å¼)" },
                { word: "our", pos: "ä»£è¯ (Pron.)", def: "æˆ‘ä»¬çš„", pron: "/ËˆaÊŠÉ™r/", example: "This is our new house.", confusable: "Are (æ˜¯), Hour (å°æ—¶)" },
                { word: "heats", pos: "åŠ¨è¯ (V.)", def: "åŠ çƒ­ (ç¬¬ä¸‰äººç§°å•æ•°)", pron: "/hiËts/", example: "The oven heats the food very quickly.", confusable: "Hits (å‡»æ‰“)" },
                { word: "taking", pos: "åŠ¨è¯ (V.)", def: "æ‹¿ï¼›å¸¦ï¼›å ç”¨", pron: "/ËˆteÉªkÉªÅ‹/", example: "She is taking a picture of the view.", confusable: "Talking (è¯´è¯)" },
                { word: "joined", pos: "åŠ¨è¯ (V.)", def: "åŠ å…¥ï¼›è¿æ¥", pron: "/dÊ’É”Éªnd/", example: "The two wires were joined together.", confusable: "Joint (å…³èŠ‚)" },
                { word: "couldn't", pos: "ç¼©å†™ (Contr.)", def: "could not (ä¸èƒ½)", pron: "/ËˆkÊŠdÉ™nt/", example: "I couldn't open the door because it was locked.", confusable: "Shouldn't (ä¸åº”è¯¥)" },
                { word: "Traveled", pos: "åŠ¨è¯ (V.)", def: "æ—…è¡Œäº† (ç¾å¼æ‹¼å†™)", pron: "/ËˆtrÃ¦vÉ™ld/", example: "They traveled across Europe last summer.", confusable: "Travelled (è‹±å¼æ‹¼å†™)" },
                { word: "Order", pos: "åè¯/åŠ¨è¯ (N./V.)", def: "é¡ºåºï¼›å‘½ä»¤ï¼›ç‚¹é¤", pron: "/ËˆÉ”ËrdÉ™r/", example: "Put the books in alphabetical order.", confusable: "Odour (æ°”å‘³)" },
                { word: "From", pos: "ä»‹è¯ (Prep.)", def: "ä»...ï¼›æ¥è‡ª...", pron: "/frÊŒm/", example: "This gift is from my aunt.", confusable: "Form (å½¢å¼)" }
            ]},
            { category: "ä¹ã€ å…¶ä»– (Others)", shortCategory: "å…¶ä»–", words: [
                { word: "Luckily", pos: "å‰¯è¯ (Adv.)", def: "å¹¸è¿åœ°", pron: "/ËˆlÊŒkÉªli/", example: "Luckily, we found a parking spot right away.", confusable: "Likely (å¯èƒ½åœ°)" },
                { word: "third", pos: "å½¢å®¹è¯ (Adj.)", def: "ç¬¬ä¸‰çš„", pron: "/Î¸ÉœËrd/", example: "She won the third prize in the competition.", confusable: "Thirst (å£æ¸´)" },
                { word: "Trip", pos: "åè¯ (N.)", def: "æ—…è¡Œï¼›ç»Šå€’", pron: "/trÉªp/", example: "We are planning a weekend trip to the mountains.", confusable: "Trap (é™·é˜±)" },
                { word: "salt", pos: "åè¯ (N.)", def: "ç›", pron: "/sÉ”Ëlt/", example: "Don't forget to add a pinch of salt.", confusable: "Sault (æ€¥æµ)" },
                { word: "United", pos: "å½¢å®¹è¯ (Adj.)", def: "è”åˆçš„ï¼›ç»Ÿä¸€çš„", pron: "/juËËˆnaÉªtÉªd/", example: "The fifty states are united in one country.", confusable: "Untied (æœªç³»ç´§çš„)" }
            ]}
        ];
        
        // --- å…¨å±€å˜é‡ ---
        let currentWordList = [];
        let currentCardIndex = 0;
        let scoreCorrect = 0; // å¬å†™æ¨¡å¼å¾—åˆ†
        let scoreTotal = 0; // å¬å†™æ¨¡å¼æ€»é¢˜æ•°
        let dogBones = 0; // å® ç‰©æ¨¡å¼ç‹—ç²®æ•°
        let dogQuizList = []; // å® ç‰©æ¨¡å¼è¯æ±‡åˆ—è¡¨
        let dogQuizIndex = 0; // å® ç‰©æ¨¡å¼å½“å‰é¢˜ç›®ç´¢å¼•

        // --- é€šç”¨å·¥å…·å‡½æ•° ---

        // è¯­éŸ³åˆæˆåŠŸèƒ½
        const speak = (text) => {
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel(); 
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US'; 
                utterance.rate = 0.9; 
                speechSynthesis.speak(utterance);
            } else {
                console.error('è¯­éŸ³åˆæˆåŠŸèƒ½ä¸å—æ”¯æŒã€‚');
            }
        };

        // æ¨¡å¼åˆ‡æ¢åŠŸèƒ½
        const showView = (viewId) => {
            ['listView', 'flashcardView', 'quizView', 'matchView', 'dogGameView'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = (id === viewId ? 'block' : 'none');
            });
            speechSynthesis.cancel();
        };

        // æ‰å¹³åŒ–å’Œæ´—ç‰Œï¼ˆæ‰€æœ‰æ¨¡å¼å…±ç”¨ï¼‰
        const prepareFlashcards = () => {
            currentWordList = [];
            vocabularyData.forEach(cat => {
                cat.words.forEach(word => {
                    currentWordList.push({ ...word, category: cat.shortCategory });
                });
            });
            
            // éšæœºæ‰“ä¹±è¯æ±‡é¡ºåº
            for (let i = currentWordList.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [currentWordList[i], currentWordList[j]] = [currentWordList[j], currentWordList[i]];
            }

            currentCardIndex = 0;
            const totalCardsElement = document.getElementById('totalCards');
            if(totalCardsElement) {
                 totalCardsElement.textContent = currentWordList.length;
            }
        };

        // --- 1. åˆ—è¡¨è§†å›¾åŠŸèƒ½ ---
        const renderVocabularyList = () => {
            const container = document.getElementById('vocabulary-list');
            if (!container) return; 

            let html = '';
            vocabularyData.forEach(cat => {
                html += `<h2>${cat.category}</h2>`;
                html += `
                    <table>
                        <thead><tr><th>å•è¯ (Word)</th><th>è¯æ€§ (P.O.S)</th><th>ä¸­æ–‡é‡Šä¹‰</th><th>å‘éŸ³ (IPA)</th><th>ä¾‹å¥ (Example Sentence)</th><th>æ˜“æ··æ·†è¯ (Confusable)</th></tr></thead>
                        <tbody>
                `;
                cat.words.forEach(word => {
                    html += `
                        <tr>
                            <td class="word-cell" data-label="å•è¯" onclick="speak('${word.word.replace(/'/g, "\\'")}')">${word.word}</td>
                            <td class="pos" data-label="è¯æ€§">${word.pos}</td>
                            <td data-label="ä¸­æ–‡é‡Šä¹‰">${word.def}</td>
                            <td class="pron" data-label="å‘éŸ³">${word.pron}</td>
                            <td data-label="ä¾‹å¥">${word.example}</td>
                            <td data-label="æ˜“æ··æ·†è¯">${word.confusable}</td>
                        </tr>
                    `;
                });
                html += `</tbody></table>`;
            });
            container.innerHTML = html;
        };
        
        // --- 2. ç¿»è½¬å¡ç‰‡å­¦ä¹ åŠŸèƒ½ ---
        const renderCard = () => {
            if (currentWordList.length === 0) return;
            const word = currentWordList[currentCardIndex];
            const flashcard = document.querySelector('.flashcard');
            if(flashcard) flashcard.classList.remove('flipped');
            const cardFront = document.getElementById('cardFront');
            const cardBack = document.getElementById('cardBack');
            const cardCount = document.getElementById('cardCount');
            const cardCategory = document.getElementById('cardCategory');
            if (cardFront && cardBack && cardCount && cardCategory) {
                cardFront.textContent = word.word;
                cardBack.innerHTML = `
                    <p class="definition">ã€${word.pos}ã€‘${word.def}</p>
                    <p><strong>ä¾‹å¥:</strong> <span class="example">${word.example}</span></p>
                    <p><strong>éŸ³æ ‡:</strong> <span class="pron">${word.pron}</span></p>
                    <p><strong>æ˜“æ··æ·†:</strong> ${word.confusable}</p>
                `;
                cardCount.textContent = currentCardIndex + 1;
                cardCategory.textContent = `åˆ†ç±»ï¼š${word.category}`;
            }
        };
        window.flipCard = () => {
            const flashcard = document.querySelector('.flashcard');
            if(flashcard) flashcard.classList.toggle('flipped');
        };
        const navigateCard = (direction) => {
            const total = currentWordList.length;
            if (total === 0) return;
            if (direction === 'next') {
                currentCardIndex = (currentCardIndex + 1) % total;
            } else if (direction === 'prev') {
                currentCardIndex = (currentCardIndex - 1 + total) % total;
            }
            renderCard();
        };


        // --- 3. å¬å†™æ¨¡å¼åŠŸèƒ½ ---
        const updateQuizScore = () => {
            document.getElementById('scoreCorrect').textContent = scoreCorrect;
            document.getElementById('scoreTotal').textContent = scoreTotal;
        };
        const initQuiz = () => {
            prepareFlashcards(); 
            scoreCorrect = 0;
            scoreTotal = 0;
            currentCardIndex = -1; 
            updateQuizScore();
            const nextBtn = document.getElementById('quizNextBtn');
            if(nextBtn) nextBtn.click();
        };
        const nextQuiz = () => {
            const total = currentWordList.length;
            if (total === 0) return;
            currentCardIndex = (currentCardIndex + 1) % total; 
            const word = currentWordList[currentCardIndex];
            document.getElementById('quizInstruction').textContent = 'ç‚¹å‡»æ’­æ”¾ï¼Œå¬å•è¯æ‹¼å†™ï¼š';
            document.getElementById('quizCategory').textContent = `åˆ†ç±»ï¼š${word.category}`;
            document.getElementById('quizInput').value = '';
            document.getElementById('quizInput').style.backgroundColor = 'white';
            document.getElementById('quizFeedback').textContent = '';
            document.getElementById('quizSubmitBtn').style.display = 'inline-block';
            document.getElementById('quizNextBtn').style.display = 'none';
            speak(word.word);
        };
        const checkQuizAnswer = () => {
            const input = document.getElementById('quizInput').value.trim();
            const correctWord = currentWordList[currentCardIndex].word;
            const feedback = document.getElementById('quizFeedback');
            const submitBtn = document.getElementById('quizSubmitBtn');
            const nextBtn = document.getElementById('quizNextBtn');
            const inputField = document.getElementById('quizInput');
            if (input === '') {
                feedback.textContent = 'è¯·è¾“å…¥ç­”æ¡ˆï¼';
                feedback.style.color = '#e74c3c';
                return;
            }
            scoreTotal++;
            if (input.toLowerCase() === correctWord.toLowerCase()) {
                scoreCorrect++;
                feedback.innerHTML = `âœ… **æ­£ç¡®ï¼** å•è¯æ˜¯ï¼š${correctWord} ( ${currentWordList[currentCardIndex].pron} )`;
                feedback.style.color = '#ff69b4'; // Kuromi Pink for correct
                inputField.style.backgroundColor = '#f7f7f7';
            } else {
                feedback.innerHTML = `âŒ **é”™è¯¯ã€‚** æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š**${correctWord}** ( ${currentWordList[currentCardIndex].pron} )`;
                feedback.style.color = '#8a2be2'; // Kuromi Purple for incorrect
                inputField.style.backgroundColor = '#fef0fe';
            }
            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
            updateQuizScore();
        };

        // --- 4. æ˜“æ··æ·†è¯é…å¯¹æ¨¡å¼åŠŸèƒ½ ---
        const renderMatchList = () => {
            const container = document.getElementById('matchListContainer');
            if (!container) return;
            const allWords = [];
            vocabularyData.forEach(cat => {
                cat.words.forEach(word => {
                    if (word.confusable && word.confusable.trim() !== '') {
                         allWords.push(word);
                    }
                });
            });
            // --- MODIFICATION 1: Centering the grid container ---
            let html = '<div style="max-width: 800px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: left;">';
            allWords.forEach(word => {
                const originalWordClean = word.word.replace(/'/g, "\\'");
                const confusableWordText = word.confusable.split('(')[0].trim();
                const confusableWordClean = confusableWordText.replace(/'/g, "\\'");
                const confusableHint = word.confusable.match(/\((.*?)\)/) ? word.confusable.match(/\((.*?)\)/)[1] : 'ç‚¹å‡»å¬å‘éŸ³';
                html += `
                    <div class="match-card">
                        <p style="margin: 0; font-size: 1.1em; color: #1a1a1a;">
                            **åŸè¯ï¼š** <strong class="word-cell" onclick="speak('${originalWordClean}')" style="cursor: pointer;">${word.word}</strong>
                            <span style="font-size: 0.9em; color: #8a2be2;"> (${word.def})</span>
                        </p>
                        <p style="margin: 5px 0 0 0; font-style: italic; color: #1a1a1a;">
                            **æ˜“æ··æ·†ï¼š** <strong class="word-cell" onclick="speak('${confusableWordClean}')" style="cursor: pointer;">${confusableWordText}</strong> 
                            <span style="font-size: 0.9em; color: #95a5a6;">(${confusableHint})</span>
                        </p>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        };


        // --- 5. å® ç‰©æŒ‘æˆ˜æ¨¡å¼åŠŸèƒ½ ---
        
        // å® ç‰©æ¨¡å¼ï¼šæ˜¾ç¤º/éšè—é”™è¯¯å›é¡¾åŒºåŸŸ
        window.toggleDogReview = () => {
            const reviewArea = document.getElementById('wordReviewArea');
            if (reviewArea) {
                // å¦‚æœå½“å‰æ˜¯éšè—çš„ï¼Œåˆ™æ”¹ä¸ºæ˜¾ç¤ºï¼›å¦‚æœæ˜¯æ˜¾ç¤ºçš„ï¼Œåˆ™æ”¹ä¸ºéšè—
                reviewArea.style.display = (reviewArea.style.display === 'none' ? 'block' : 'none');
                
                // å¦‚æœæ˜¯å±•å¼€ï¼Œå°è¯•æ’­æ”¾å•è¯
                if (reviewArea.style.display === 'block' && dogQuizList.length > 0) {
                     speak(dogQuizList[dogQuizIndex].word);
                }
            }
        };

        const initDogGame = () => {
            dogBones = 0;
            
            dogQuizList = [];
            vocabularyData.forEach(cat => {
                cat.words.forEach(word => {
                    dogQuizList.push({ 
                        ...word, 
                        questionType: 'spell_en', // æ˜ç¡®è®¾ç½®ä¸ºæ‹¼å†™æŒ‘æˆ˜
                    });
                });
            });
            
            // éšæœºæ‰“ä¹±
            for (let i = dogQuizList.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [dogQuizList[i], dogQuizList[j]] = [dogQuizList[j], dogQuizList[i]];
            }

            dogQuizIndex = -1; 
            document.getElementById('boneCount').textContent = dogBones;
            updateDogVisuals();
            
            const nextBtn = document.getElementById('dogGameNextBtn');
            if (nextBtn) nextBtn.click(); 
        };
        
        const updateDogVisuals = () => {
            const dogAvatar = document.getElementById('dogAvatar');
            const dogMood = document.getElementById('dogMood');
            const dogStatus = document.getElementById('dogStatus');
            const boneCount = document.getElementById('boneCount');

            if (!dogAvatar || !dogMood || !dogStatus) return;
            
            boneCount.textContent = dogBones;

            // --- MODIFICATION 2: Change "éª¨å¤´" to "ç‹—ç²®" and "å—" to "ä»½" ---
            if (dogBones === 0) {
                dogAvatar.textContent = 'ğŸ•';
                dogMood.textContent = 'å°ç‹—å¾ˆå…´å¥‹ï¼Œä½†è‚šå­æœ‰ç‚¹é¥¿...';
                dogStatus.textContent = 'ğŸš åŠªåŠ›ç­”é¢˜èµšç‹—ç²®ï¼';
            } else if (dogBones < 10) {
                dogAvatar.textContent = 'ğŸ¶';
                dogMood.textContent = `å°ç‹—åƒäº† ${dogBones} ä»½ç‹—ç²®ï¼Œå¿ƒæƒ…å¾ˆä¸é”™ï¼`;
                dogStatus.textContent = 'å¹²å¾—æ¼‚äº®ï¼ç»§ç»­å–‚é£Ÿï¼';
            } else {
                dogAvatar.textContent = 'ğŸ•â€ğŸ¦º';
                dogMood.textContent = `ğŸ¥³ å°ç‹—è¶…çº§æ»¡è¶³ï¼æ€»å…± ${dogBones} ä»½ç‹—ç²®ï¼`;
                dogStatus.textContent = 'ä½ çœŸæ˜¯ä¸ªä¼˜ç§€çš„å®¶é•¿ï¼';
            }
        };

        const nextDogGameQuestion = () => {
            if (dogQuizList.length === 0) return;
            
            dogQuizIndex = (dogQuizIndex + 1) % dogQuizList.length;
            const question = dogQuizList[dogQuizIndex];
            
            // --- æ ¸å¿ƒå˜åŒ–ï¼šé—®é¢˜æ”¹ä¸ºæ ¹æ®ä¸­æ–‡é‡Šä¹‰æ‹¼å†™è‹±æ–‡å•è¯ ---
            const questionText = `ã€${question.category}ã€‘è¯·æ ¹æ®ä¸­æ–‡é‡Šä¹‰ **${question.def}** (${question.pos})ï¼Œæ‹¼å†™å‡ºæ­£ç¡®çš„è‹±æ–‡å•è¯ã€‚`;

            // é‡ç½®å›é¡¾åŒºåŸŸ
            const memorizeBtn = document.getElementById('memorizeWordBtn');
            const reviewArea = document.getElementById('wordReviewArea');
            if (memorizeBtn) memorizeBtn.style.display = 'none';
            if (reviewArea) reviewArea.style.display = 'none';

            // é‡ç½®ç•Œé¢
            document.getElementById('dogGameQuestion').innerHTML = questionText; 
            document.getElementById('dogGameInput').value = '';
            document.getElementById('dogGameInput').placeholder = 'åœ¨æ­¤è¾“å…¥è‹±æ–‡å•è¯æ‹¼å†™'; // ç¡®ä¿æç¤ºæ­£ç¡®
            document.getElementById('dogGameInput').style.backgroundColor = 'white';
            document.getElementById('dogGameInput').style.color = '#1a1a1a'; // Ensure input text is dark
            document.getElementById('dogGameFeedback').textContent = '';
            document.getElementById('dogGameSubmitBtn').style.display = 'inline-block';
            document.getElementById('dogGameNextBtn').style.display = 'none';

            // æ­¤å¤„ä¸æ’­æ”¾å•è¯ï¼Œå› ä¸ºæ˜¯æ‹¼å†™æŒ‘æˆ˜
        };

        const checkDogGameAnswer = () => {
            const input = document.getElementById('dogGameInput').value.trim();
            const currentQuestion = dogQuizList[dogQuizIndex];
            const feedback = document.getElementById('dogGameFeedback');
            const submitBtn = document.getElementById('dogGameSubmitBtn');
            const nextBtn = document.getElementById('dogGameNextBtn');
            const inputField = document.getElementById('dogGameInput');
            
            const memorizeBtn = document.getElementById('memorizeWordBtn');
            const reviewArea = document.getElementById('wordReviewArea');
            const reviewContent = document.getElementById('reviewContent');


            if (input === '') {
                feedback.textContent = 'è¯·è¾“å…¥ç­”æ¡ˆï¼';
                feedback.style.color = '#8a2be2';
                return;
            }

            // --- æ ¸å¿ƒå˜åŒ–ï¼šæ£€æŸ¥è¾“å…¥ï¼ˆè‹±æ–‡æ‹¼å†™ï¼‰æ˜¯å¦ç­‰äºæ­£ç¡®å•è¯ ---
            const correctWord = currentQuestion.word;
            const correctAnswerDisplay = `**${correctWord}** (ä¸­æ–‡: ${currentQuestion.def})`;

            let isCorrect = (input.toLowerCase() === correctWord.toLowerCase());

            if (isCorrect) {
                dogBones++;
                // --- MODIFICATION 2: Change "éª¨å¤´" to "ç‹—ç²®" and "å—" to "ä»½" (Correct Feedback) ---
                feedback.innerHTML = `ğŸš **æ‹¼å†™æ­£ç¡®ï¼** å•è¯æ˜¯ï¼š${correctAnswerDisplay}ã€‚å°ç‹—è·å¾—äº† 1 ä»½ç‹—ç²®ï¼`;
                feedback.style.color = '#ff69b4'; // Kuromi Pink
                inputField.style.backgroundColor = '#f7f7f7'; // Light Gray
                inputField.style.color = '#1a1a1a';

                // ç­”å¯¹æ—¶æœ—è¯»å•è¯
                speak(correctWord);

                if (memorizeBtn) memorizeBtn.style.display = 'none';
                if (reviewArea) reviewArea.style.display = 'none';
            } else {
                feedback.innerHTML = `ğŸ˜­ **æ‹¼å†™é”™è¯¯ã€‚** æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correctAnswerDisplay}ã€‚å°ç‹—å¾ˆä¼¤å¿ƒ...`;
                feedback.style.color = '#8a2be2'; // Kuromi Purple
                inputField.style.backgroundColor = '#fef0fe'; // Very Light Pink
                inputField.style.color = '#1a1a1a';
                
                // ç­”é”™æ—¶æœ—è¯»å•è¯ï¼Œæ–¹ä¾¿å³æ—¶å­¦ä¹ 
                speak(correctWord);

                // --- é”™è¯¯å›é¡¾é€»è¾‘ï¼šæ˜¾ç¤ºæŒ‰é’®å¹¶å¡«å……å†…å®¹ ---
                if (memorizeBtn) memorizeBtn.style.display = 'inline-block';

                if (reviewContent && currentQuestion) {
                    reviewContent.innerHTML = `
                        <p style="margin: 5px 0;"><strong>è‹±æ–‡å•è¯:</strong> <span style="font-size: 1.2em; cursor: pointer;" onclick="speak('${currentQuestion.word.replace(/'/g, "\\'")}')">${currentQuestion.word}</span></p>
                        <p style="margin: 5px 0;"><strong>ä¸­æ–‡é‡Šä¹‰:</strong> ${currentQuestion.def}</p>
                        <p style="margin: 5px 0;"><strong>è¯æ€§/éŸ³æ ‡:</strong> ${currentQuestion.pos} / <span style="color: #27ae60;">${currentQuestion.pron}</span></p>
                        <p style="margin: 5px 0;"><strong>ä¾‹å¥:</strong> <em>${currentQuestion.example}</em></p>
                        <p style="margin: 5px 0;"><strong>æ˜“æ··æ·†è¯:</strong> ${currentQuestion.confusable}</p>
                    `;
                    // é»˜è®¤ä¸å±•å¼€ï¼Œç­‰å¾…ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
                }
            }

            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
            updateDogVisuals();
        };

        // å® ç‰©æ¨¡å¼å›è½¦é”®å¤„ç†
        const handleDogGameKeyPress = (event) => {
             if (event.key === 'Enter') {
                const submitBtn = document.getElementById('dogGameSubmitBtn');
                const nextBtn = document.getElementById('dogGameNextBtn');
                
                if (submitBtn.style.display !== 'none') {
                    checkDogGameAnswer();
                } else if (nextBtn.style.display !== 'none') {
                    nextDogGameQuestion();
                }
            }
        };

        // --- å¯åŠ¨é€»è¾‘å’Œäº‹ä»¶ç»‘å®š ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. æ¸²æŸ“åˆ—è¡¨è§†å›¾ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
            renderVocabularyList();
            showView('listView');
            
            // 2. ç»‘å®šæ¨¡å¼åˆ‡æ¢æŒ‰é’®
            const listViewBtn = document.getElementById('listViewBtn');
            const flashcardBtn = document.getElementById('flashcardBtn');
            const quizModeBtn = document.getElementById('quizModeBtn');
            const matchModeBtn = document.getElementById('matchModeBtn');
            const dogGameBtn = document.getElementById('dogGameBtn');

            if (listViewBtn) listViewBtn.addEventListener('click', () => showView('listView'));
            
            if (flashcardBtn) flashcardBtn.addEventListener('click', () => {
                prepareFlashcards(); 
                if (currentWordList.length > 0) {
                    renderCard();
                    showView('flashcardView');
                }
            });
            
            if (quizModeBtn) quizModeBtn.addEventListener('click', () => {
                showView('quizView');
                initQuiz();
            });
            
            if (matchModeBtn) matchModeBtn.addEventListener('click', () => {
                renderMatchList();
                showView('matchView');
            });
            
            if (dogGameBtn) dogGameBtn.addEventListener('click', () => {
                showView('dogGameView');
                initDogGame();
            });

            // 3. ç»‘å®šå¡ç‰‡å¯¼èˆªæŒ‰é’®
            const nextCardBtn = document.getElementById('nextCardBtn');
            const prevCardBtn = document.getElementById('prevCardBtn');
            if (nextCardBtn) nextCardBtn.addEventListener('click', () => navigateCard('next'));
            if (prevCardBtn) prevCardBtn.addEventListener('click', () => navigateCard('prev'));

            // 4. ç»‘å®šå¬å†™æ¨¡å¼æŒ‰é’® (ä¸å˜)
            const quizSpeakBtn = document.getElementById('quizSpeakBtn');
            const quizSubmitBtn = document.getElementById('quizSubmitBtn');
            const quizNextBtn = document.getElementById('quizNextBtn');
            const quizInput = document.getElementById('quizInput');

            if (quizSpeakBtn) quizSpeakBtn.addEventListener('click', () => {
                if (currentWordList.length > 0 && currentCardIndex > -1) {
                    speak(currentWordList[currentCardIndex].word);
                }
            });
            if (quizSubmitBtn) quizSubmitBtn.addEventListener('click', checkQuizAnswer);
            if (quizNextBtn) quizNextBtn.addEventListener('click', nextQuiz);
            if (quizInput) quizInput.addEventListener('keypress', (event) => {
                 if (event.key === 'Enter') {
                    if (quizSubmitBtn.style.display !== 'none') {
                        checkQuizAnswer();
                    } else if (quizNextBtn.style.display !== 'none') {
                        nextQuiz();
                    }
                }
            });

            // 5. ç»‘å®šå® ç‰©æŒ‘æˆ˜æ¨¡å¼æŒ‰é’® (å·²ä¿®æ”¹é€»è¾‘)
            const dogGameSubmitBtn = document.getElementById('dogGameSubmitBtn');
            const dogGameNextBtn = document.getElementById('dogGameNextBtn');
            const dogGameInput = document.getElementById('dogGameInput');

            if (dogGameSubmitBtn) dogGameSubmitBtn.addEventListener('click', checkDogGameAnswer);
            if (dogGameNextBtn) dogGameNextBtn.addEventListener('click', nextDogGameQuestion);
            if (dogGameInput) dogGameInput.addEventListener('keypress', handleDogGameKeyPress);
        });
    </script>
</body>
</html>